<!-- CSS -->
<style>
  body {
    font-family: 'Inter', sans-serif;
    line-height: 1.5;
    color: #111827;
    background: linear-gradient(135deg, #ea384c 0%, #ff6b6b 100%);
    min-height: 100vh;
    padding: 1rem;
  }

  .page-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0;
  }

  .page-header {
    text-align: center;
    margin-bottom: 2rem;
    color: white;
  }

  .page-title {
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 0.75rem;
  }

  .page-title .white-text {
    color: white;
  }

  .page-title .highlight-text {
    color: #FFB347;
  }

  .page-subtitle {
    font-size: 1.25rem;
    opacity: 0.9;
  }

  .form-container {
    max-width: 600px;
    margin: 0 auto;
    padding: 1.5rem;
    background: white;
    border-radius: 24px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    min-height: auto;
    display: block;
  }

  .form-step {
    display: none;
    padding-top: 0;
  }

  .form-step.active {
    display: block;
  }

  .form-step h3 {
    font-size: 2rem;
    font-weight: 600;
    color: #111827;
    margin: 0 0 1rem 0;
    line-height: 1.2;
    padding-top: 0;
  }

  @media (max-width: 640px) {
    .form-step h3 {
      font-size: 1.75rem;
      margin: 0 0 1.5rem 0;
    }
  }

  .form-option {
    background: #f3f4f6;
    border: 1px solid #e5e7eb;
    border-radius: 12px;
    padding: 1rem;
    margin-bottom: 0.75rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .form-option:hover {
    border-color: #2563EB;
  }

  .option-letter {
    width: 32px;
    height: 32px;
    background: white;
    border: 1px solid #d1d5db;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 500;
    color: #111827;
  }

  .form-input {
    width: 100%;
    padding: 12px;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    margin-bottom: 16px;
  }

  .submit-button {
    width: 100%;
    padding: 14px;
    background: #2563EB;
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: 500;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
  }

  .submit-button:hover {
    background: #1d4ed8;
  }

  .page-footer {
    text-align: center;
    color: white;
    margin-top: 3rem;
    font-size: 0.875rem;
    opacity: 0.8;
  }
</style>

<!-- HTML -->
<div class="page-container">
  <header class="page-header">
    <h1 class="page-title">
      <span class="white-text">COMPARA LAS MEJORES OFERTAS DE LUZ Y GAS Y</span>
      <span class="highlight-text">AHORRA HASTA UN 50% EN TU FACTURA</span>
    </h1>
    <p class="page-subtitle">Compara y ahorra en tu factura de luz</p>
  </header>

  <div class="form-container">
    <form id="energyForm" action="https://leadstudio.leadbyte.co.uk/api/submit.php" method="POST" target="_blank">
      <input type="hidden" name="returnjson" value="yes">
      <input type="hidden" name="campid" value="GAZELEC-ESPAGNE">
      <input type="hidden" name="source" value="">
      <input type="hidden" name="type_energie" value="electricite">
      <input type="hidden" name="objectif_recherche" value="economiser">
      <input type="hidden" name="b2b" value="no">

      <!-- Step 1 -->
      <div class="form-step active" data-step="1">
        <h3>Seleccione el tipo de cliente:</h3>
        <label class="form-option">
          <div class="option-letter">A</div>
          <input type="radio" name="clientType" value="particular"> Particular
        </label>
        <label class="form-option">
          <div class="option-letter">B</div>
          <input type="radio" name="clientType" value="autonomo"> Autónomo / Pyme
        </label>
      </div>

      <!-- Step 2 -->
      <div class="form-step" data-step="2">
        <h3>¿Qué tipo de vivienda tienes?</h3>
        <label class="form-option">
          <div class="option-letter">A</div>
          <input type="radio" name="houseType" value="apartamento"> Apartamento o casa pequeña
        </label>
        <label class="form-option">
          <div class="option-letter">B</div>
          <input type="radio" name="houseType" value="casa"> Casa grande o chale
        </label>
        <label class="form-option">
          <div class="option-letter">C</div>
          <input type="radio" name="houseType" value="otro"> Otro tipo de vivienda
        </label>
      </div>

      <!-- Step 3 -->
      <div class="form-step" data-step="3">
        <h3>¿Cuál es tu compañía actual?</h3>
        <label class="form-option">
          <div class="option-letter">A</div>
          <input type="radio" name="currentCompany" value="gana"> Gana Energia
        </label>
        <label class="form-option">
          <div class="option-letter">B</div>
          <input type="radio" name="currentCompany" value="repsol"> Repsol
        </label>
        <label class="form-option">
          <div class="option-letter">C</div>
          <input type="radio" name="currentCompany" value="iberdrola"> Iberdrola
        </label>
        <label class="form-option">
          <div class="option-letter">D</div>
          <input type="radio" name="currentCompany" value="eniplenitude"> Eniplenitude
        </label>
        <label class="form-option">
          <div class="option-letter">E</div>
          <input type="radio" name="currentCompany" value="endesa"> Endesa
        </label>
        <label class="form-option">
          <div class="option-letter">F</div>
          <input type="radio" name="currentCompany" value="otro"> Otro/No lo sé
        </label>
      </div>

      <!-- Step 4 -->
      <div class="form-step" data-step="4">
        <h3>¿Cuál es el monto de tu factura mensual actual?</h3>
        <label class="form-option">
          <div class="option-letter">A</div>
          <input type="radio" name="monthlyBill" value="menos-50"> Menos de 50 € al mes
        </label>
        <label class="form-option">
          <div class="option-letter">B</div>
          <input type="radio" name="monthlyBill" value="50-100"> Entre 50 € y 100 € al mes
        </label>
        <label class="form-option">
          <div class="option-letter">C</div>
          <input type="radio" name="monthlyBill" value="100-150"> Entre 100 € y 150 € al mes
        </label>
        <label class="form-option">
          <div class="option-letter">D</div>
          <input type="radio" name="monthlyBill" value="mas-150"> Más de 150 € al mes
        </label>
        <label class="form-option">
          <div class="option-letter">E</div>
          <input type="radio" name="monthlyBill" value="no-se"> No lo sé
        </label>
      </div>

      <!-- Step 5 -->
      <div class="form-step" data-step="5">
        <h3>Información de contacto</h3>
        <input type="text" name="postcode" class="form-input" placeholder="Código postal" required>
        <input type="text" name="towncity" class="form-input" placeholder="Ciudad" required>
        <input type="text" name="fullName" class="form-input" placeholder="Nombre completo" required>
        <input type="email" name="email" class="form-input" placeholder="Email" required>
        <input type="tel" name="phone1" class="form-input" placeholder="+34XXXXXXXXX" required>
        
        <label style="display: block; margin-bottom: 20px;">
          <input type="checkbox" name="gdprConsent" required>
          Al hacer clic en «Enviar», confirmo que he leído y acepto las 
          <a href="https://comparadorluzgas.com/gaz-y-luz-condiciones-generales/" target="_blank">condiciones generales de uso</a>.
        </label>
        
        <button type="submit" class="submit-button">
          Enviar
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M5 12h14"></path>
            <path d="m12 5 7 7-7 7"></path>
          </svg>
        </button>
      </div>
    </form>
  </div>

  <footer class="page-footer">
    <p>© 2024 Comparador Energético. Todos los derechos reservados.</p>
  </footer>
</div>

<!-- JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  let currentStep = 1;
  const form = document.getElementById('energyForm');

  // Set source value from current URL
  document.querySelector('input[name="source"]').value = window.location.href;

  function showStep(step) {
    document.querySelectorAll('.form-step').forEach(s => s.classList.remove('active'));
    const currentStepElement = document.querySelector(`[data-step="${step}"]`);
    if (currentStepElement) {
      currentStepElement.classList.add('active');
    }
  }

  document.querySelectorAll('input[type="radio"]').forEach(radio => {
    radio.addEventListener('change', function() {
      if (currentStep < 5) {
        currentStep++;
        showStep(currentStep);
      }
    });
  });

  function validateSpanishPhone(phone) {
    const spanishPhoneRegex = /^\+34[0-9]{9}$/;
    return spanishPhoneRegex.test(phone);
  }

  function validateSpanishPostalCode(postalCode) {
    const spanishPostalCodeRegex = /^(?:0[1-9]|[1-4][0-9]|5[0-2])[0-9]{3}$/;
    return spanishPostalCodeRegex.test(postalCode);
  }

  form.addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(form);
    const phone = formData.get('phone1');
    const postalCode = formData.get('postcode');
    const fullName = formData.get('fullName');
    
    if (!validateSpanishPhone(phone)) {
      alert('Por favor, introduzca un número de teléfono español válido (+34XXXXXXXXX)');
      return;
    }

    if (!validateSpanishPostalCode(postalCode)) {
      alert('Por favor, introduzca un código postal español válido (5 dígitos)');
      return;
    }

    const [firstname = "", lastname = ""] = fullName.split(" ");
    formData.append('firstname', firstname);
    formData.append('lastname', lastname);

    // Create a temporary form for submission
    const tempForm = document.createElement('form');
    tempForm.method = 'POST';
    tempForm.action = 'https://leadstudio.leadbyte.co.uk/api/submit.php';
    tempForm.target = '_blank';

    // Add all form data to the temporary form
    for (const [key, value] of formData.entries()) {
      const input = document.createElement('input');
      input.type = 'hidden';
      input.name = key;
      input.value = value;
      tempForm.appendChild(input);
    }

    // Add form to body, submit it, and remove it
    document.body.appendChild(tempForm);
    tempForm.submit();
    document.body.removeChild(tempForm);

    // Redirect after a short delay
    setTimeout(() => {
      window.location.href = '/gracias';
    }, 1000);
  });
});
</script>
